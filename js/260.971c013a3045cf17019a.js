!function(e,o){if("object"==typeof exports&&"object"==typeof module)module.exports=o();else if("function"==typeof define&&define.amd)define([],o);else{var t=o();for(var n in t)("object"==typeof exports?exports:e)[n]=t[n]}}(self,(()=>(()=>{var e,o,t={74189:(e,o,t)=>{"use strict";var n=t(45770),r=t(91519),a=t.n(r),i=t(92629),s=t(29550),l=t.n(s),c=t(12883),p=t(85811),u=t.n(p),f=t(36694).lW;function d(e,o){if(e){if("string"==typeof e)return g(e,o);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?g(e,o):void 0}}function g(e,o){(null==o||o>e.length)&&(o=e.length);for(var t=0,n=new Array(o);t<o;t++)n[t]=e[t];return n}self.requestFileSystemSync=self.webkitRequestFileSystemSync||self.requestFileSystemSync,self.resolveLocalFileSystemSyncURL=self.webkitResolveLocalFileSystemSyncURL||self.resolveLocalFileSystemSyncURL;var v=new FileReaderSync,y=new(l())({allErrors:!0,useDefaults:!0});y.addKeyword({keyword:"example",type:"string"});var m=y.compile(i),h='\n +-------------------------------------------------------------------+ \n | Internal "Heta compiler" error, contact the developers.           | \n | Create an issue: '.concat(c.bugs.url," | \n | or mail to: ").concat(c.bugs.email,"                                     | \n +-------------------------------------------------------------------+ \n");function b(e,o){var t=e._container.logger,n=a().resolve(o.fullPath,e.filepath),r='Exporting to "'.concat(n,'" of format "').concat(e.format,'"...');t.info(r),e.make().forEach((function(n){try{var r=e.filepath+n.pathSuffix;!function(e,o,t){var n,r=o.split("/"),a=r.pop(),i=e,s=function(e,o){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=d(e))){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw a}}}}(r);try{for(s.s();!(n=s.n()).done;){var l=n.value;i=i.getDirectory(l,{create:!0,exclusive:!1})}}catch(e){s.e(e)}finally{s.f()}i.getFile(a,{create:!0,exclusive:!0}).createWriter().write(t)}(o,r,new Blob([n.content]))}catch(e){var a='Heta compiler cannot export to file: "'.concat(r,'": \n\t- ').concat(e.message);t.error(a,{type:"ExportError"})}}))}self.onmessage=function(e){postMessage({action:"console",value:"heta build",append:!0}),postMessage({action:"console",value:'\nRunning compilation with declaration file "/platform.json"...',append:!0});var o=self.resolveLocalFileSystemSyncURL(e.data.url+"/platform.json").file(),t=v.readAsText(o);try{var r=JSON.parse(t)}catch(e){return postMessage({action:"console",value:"\nDeclaration file must be JSON formatted:",append:!0}),postMessage({action:"console",value:"\n\t- ".concat(e.message),append:!0}),void postMessage({action:"console",value:"\n\n$ ",append:!0})}if(!m(r))return postMessage({action:"console",value:"\nErrors in declaration file:",append:!0}),m.errors.forEach((function(e){var o='\n\t- "'.concat(e.instancePath,'" ').concat(e.message);postMessage({action:"console",value:o,append:!0})})),void postMessage({action:"console",value:"\n\n$ ",append:!0});if(!u().satisfies(c.version,r.builderVersion))return postMessage({action:"console",value:"\nVersion requirements (".concat(r.builderVersion,") don't meet builder version ").concat(c.version,"."),append:!0}),void postMessage({action:"console",value:"\n\n$ ",append:!0});try{var i=function(e,o){var t="/",r=new n.Container;r.logger.addTransport((function(e,o,t,n){var r="\n[".concat(e,"]\t").concat(o);postMessage({action:"console",value:r,append:!0})}));var i=a().resolve(t),s=a().resolve(t,o.options.distDir),l=a().resolve(t,o.options.metaDir),p=a().resolve(t,o.options.logPath);r.logger.info("Heta builder of version ".concat(c.version,' initialized in directory "').concat(i,'"')),o.id&&r.logger.info('Platform id: "'.concat(o.id,'"')),r.logger.info('Compilation of module "'.concat(o.importModule.source,'" of type "').concat(o.importModule.type,'"...'));var u=new n.ModuleSystem(r.logger,(function(o){try{var t=self.resolveLocalFileSystemSyncURL(e+o).file(),n=v.readAsArrayBuffer(t)}catch(e){throw new Error("File ".concat(o," is not found."))}return f.from(n)})),y=a().join(i,o.importModule.source),m=o.importModule.type;u.addModuleDeep(y,m,o.importModule),o.options.debug&&Object.values(u.moduleCollection).forEach((function(e){var o=a().relative(i,e.filename+".json"),t=a().join(l,o),n=JSON.stringify(e.parsed,null,2);fs.outputFileSync(t,n),r.logger.info("Meta file was saved to ".concat(t))}));var h,S=u.integrate();if(r.loadMany(S,!1),r.logger.info("Setting references in elements, total length "+r.length),r.knitMany(),r.logger.info("Checking for circular references in Records."),r.checkCircRecord(),r.checkCircUnitDef(),r.logger.hasErrors)r.logger.warn("Units checking and export were skipped because of errors in compilation.");else{o.options.unitsCheck?(r.logger.info("Checking unit's consistency."),r.checkUnits()):r.logger.warn('Units checking skipped. To turn it on set "unitsCheck: true" in declaration.'),r.logger.info("Checking unit's terms."),r.checkTerms();var w=self.resolveLocalFileSystemSyncURL(e).getDirectory(s,{create:!0});if(o.options.skipExport)r.logger.warn("Exporting skipped as stated in declaration.");else if(o.options.juliaOnly)r.logger.warn('"Julia only" mode'),b(new(0,this.container.classes.Julia)({format:"Julia",filepath:"_julia"}),w);else{var M=(h=r.exportStorage,function(e){if(Array.isArray(e))return g(e)}(h)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(h)||d(h)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map((function(e){return e[1]}));r.logger.info("Start exporting to files, total: ".concat(M.length,".")),M.forEach((function(e){return b(e,w)}))}}var x=r.hetaErrors();if("always"===o.options.logMode||"error"===o.options.logMode&&x.length>0){if("json"===o.options.logFormat)var j=JSON.stringify(r.defaultLogs,null,2);else j=r.defaultLogs.map((function(e){return"[".concat(e.level,"]\t").concat(e.msg)})).join("\n");self.resolveLocalFileSystemSyncURL(e).getFile(p,{create:!0}).createWriter().write(new Blob([j],{type:"text/plain"})),r.logger.info('All logs was saved to file: "'.concat(p,'"'))}return r.logger.hasErrors?postMessage({action:"stop",logPath:p}):postMessage({action:"finished",dist:s,logPath:p}),r}(e.data.url,r)}catch(e){return postMessage({action:"console",value:h+"\n",append:!0}),postMessage({action:"console",value:e.stack,append:!0}),void postMessage({action:"console",value:"\n\n$ ",append:!0})}i.hetaErrors().length>0?postMessage({action:"console",value:"\nCompilation ERROR! See logs.",append:!0}):postMessage({action:"console",value:"\nCompilation OK!",append:!0}),postMessage({action:"console",value:"\n\n$ ",append:!0})}},52361:()=>{},94616:()=>{},75042:()=>{}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.loaded=!0,a.exports}return r.m=t,r.x=()=>{var e=r.O(void 0,[3169],(()=>r(74189)));return r.O(e)},r.amdD=function(){throw new Error("define cannot be used indirect")},r.amdO={},e=[],r.O=(o,t,n,a)=>{if(!t){var i=1/0;for(p=0;p<e.length;p++){for(var[t,n,a]=e[p],s=!0,l=0;l<t.length;l++)(!1&a||i>=a)&&Object.keys(r.O).every((e=>r.O[e](t[l])))?t.splice(l--,1):(s=!1,a<i&&(i=a));if(s){e.splice(p--,1);var c=n();void 0!==c&&(o=c)}}return o}a=a||0;for(var p=e.length;p>0&&e[p-1][2]>a;p--)e[p]=e[p-1];e[p]=[t,n,a]},r.n=e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return r.d(o,{a:o}),o},r.d=(e,o)=>{for(var t in o)r.o(o,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:o[t]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((o,t)=>(r.f[t](e,o),o)),[])),r.u=e=>"js/"+e+".cb4d2aa3004411758d2e.js",r.miniCssF=e=>{},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var o=r.g.document;if(!e&&o&&(o.currentScript&&(e=o.currentScript.src),!e)){var t=o.getElementsByTagName("script");if(t.length)for(var n=t.length-1;n>-1&&!e;)e=t[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e+"../"})(),(()=>{var e={260:1};r.f.i=(o,t)=>{e[o]||importScripts(r.p+r.u(o))};var o=self.webpackChunkheta_online=self.webpackChunkheta_online||[],t=o.push.bind(o);o.push=o=>{var[n,a,i]=o;for(var s in a)r.o(a,s)&&(r.m[s]=a[s]);for(i&&i(r);n.length;)e[n.pop()]=1;t(o)}})(),o=r.x,r.x=()=>r.e(3169).then(o),r.x()})()));