{"version":3,"file":"js/929.dd928c254dbe7a9fed8a.js","mappings":"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","sources":["webpack://heta-online/webpack/runtime/chunk loaded","webpack://heta-online/webpack/runtime/startup chunk dependencies","webpack://heta-online/./src/build.js","webpack://heta-online/webpack/bootstrap","webpack://heta-online/webpack/runtime/amd define","webpack://heta-online/webpack/runtime/amd options","webpack://heta-online/webpack/runtime/compat get default export","webpack://heta-online/webpack/runtime/define property getters","webpack://heta-online/webpack/runtime/ensure chunk","webpack://heta-online/webpack/runtime/get javascript chunk filename","webpack://heta-online/webpack/runtime/get mini-css chunk filename","webpack://heta-online/webpack/runtime/global","webpack://heta-online/webpack/runtime/hasOwnProperty shorthand","webpack://heta-online/webpack/runtime/make namespace object","webpack://heta-online/webpack/runtime/node module decorator","webpack://heta-online/webpack/runtime/publicPath","webpack://heta-online/webpack/runtime/importScripts chunk loading","webpack://heta-online/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var next = __webpack_require__.x;\n__webpack_require__.x = () => {\n\treturn Promise.all([\n\t\t__webpack_require__.e(4),\n\t\t__webpack_require__.e(926)\n\t]).then(next);\n};","import { Container, ModuleSystem } from 'heta-compiler/src/webpack';\nimport path from 'path';\nimport declarationSchema from 'heta-compiler/src/builder/declaration-schema.json';\nimport Ajv from 'ajv';\nimport hetaCompilerPackage from 'heta-compiler/package.json';\nimport semver from 'semver';\nimport { load as yamlLoad } from 'js-yaml';\n\nlet ajv = new Ajv({allErrors: true, useDefaults: true});\najv.addKeyword({\n    keyword: \"example\",\n    type: \"string\",\n});\n//ajvErrors(ajv, {singleError: false}); // this is required for custom messages see https://ajv.js.org/packages/ajv-errors.html\nconst validate = ajv.compile(declarationSchema);\n\nlet contactMessage = `\n +-------------------------------------------------------------------+ \n | Internal \"Heta compiler\" error, contact the developers.           | \n | Create an issue: ${hetaCompilerPackage.bugs.url} | \n | or mail to: ${hetaCompilerPackage.bugs.email}                                      | \n +-------------------------------------------------------------------+ \n`;\n\nconst levels = [\n    'debug', // 0\n    'info', // 1\n    'warn', // 2\n    'error', // 3\n    'panic' // 4\n];\n\nself.onmessage = (evt) => {\n    let inputDict = evt.data.files;\n    // first lines in console\n    postMessage({action: 'console', value: 'heta build'});\n\n    // search declaration\n    let declarationFileName = ['/platform.json', '/platform.json5', '/platform.yml'].find((x) => inputDict[x]);\n    let declarationBuffer = inputDict[declarationFileName];\n    if (!declarationBuffer) {\n        postMessage({action: 'console', value: '\\n\"platform.*\" file is not found.\\nSTOP!\\n\\n$ '});\n        return; // BRAKE\n    }\n\n    postMessage({action: 'console', value: `\\nRunning compilation with declaration file \"${declarationFileName}\"...`});\n    let declarationText = new TextDecoder('utf-8').decode(declarationBuffer);\n    try {\n        //var declaration = JSON.parse(declarationText);\n        var declaration = yamlLoad(declarationText);\n    } catch (e) {\n        postMessage({action: 'console', value: `\\nDeclaration file must be JSON formatted:`});\n        postMessage({action: 'console', value: `\\n\\t- ${e.message}`});\n        \n        postMessage({action: 'console', value: '\\n\\n$ '});\n        return; // BRAKE\n    }\n\n    // validate and set defaults\n    let valid = validate(declaration);\n    if (!valid) { // analyze errors\n        postMessage({action: 'console', value: '\\nErrors in declaration file:'});\n        validate.errors.forEach((ajvError) => {\n            let msg = `\\n\\t- \"${ajvError.instancePath}\" ${ajvError.message}`;\n            postMessage({action: 'console', value: msg});\n        });\n\n        postMessage({action: 'console', value: '\\n\\n$ '});\n        return;\n    }\n\n    // === wrong version throws, if no version stated than skip ===\n    let satisfiesVersion = semver.satisfies(hetaCompilerPackage.version, declaration.builderVersion);\n    if (!satisfiesVersion) {\n        postMessage({action: 'console', value: `\\nVersion requirements (${declaration.builderVersion}) don't meet builder version ${hetaCompilerPackage.version}.`});\n        \n        postMessage({action: 'console', value: '\\n\\n$ '});\n        return;\n    }\n\n    // === this part displays \"send errors to developer\" message ===\n    try {\n        var container = build(inputDict, declaration);\n    } catch(error) {\n        //throw error;\n        postMessage({action: 'console', value: contactMessage + '\\n'});\n        postMessage({action: 'console', value: error.stack});\n\n        postMessage({action: 'console', value: '\\n\\n$ '});\n        return;\n    }\n\n    if (container.hetaErrors().length > 0) {\n        postMessage({action: 'console', value: '\\nCompilation ERROR! See logs.'});\n    } else {\n        postMessage({action: 'console', value: '\\nCompilation OK!'});\n    }\n\n    postMessage({action: 'console', value: '\\n\\n$ '});\n};\n\nfunction build(inputDict, settings) { // modules, exports\n    let coreDirname = '/';\n    /*\n        constructor()\n    */\n\n    // create container and logger\n    let c = new Container();\n    \n    /*\n    c.logger.addTransport((level, msg, opt, levelNum) => { // temporal solution, all logs to console\n        console.log(`{heta-compiler} [${level}]\\t${msg}`);\n    });\n    */\n    let minLogLevel = settings.options?.logLevel || 'info';\n    let minLevelNum = levels.indexOf(minLogLevel);\n    c.logger.addTransport((level, msg, opt, levelNum) => {\n        let value = `\\n[${level}]\\t${msg}`;\n        if (levelNum >= minLevelNum) {\n            postMessage({action: 'console', value: value});\n        }\n    });\n\n    // file paths\n    let _coreDirname = path.resolve(coreDirname);\n    let _distDirname = path.resolve(coreDirname, settings.options.distDir);\n    let _metaDirname = path.resolve(coreDirname, settings.options.metaDir);\n    let _logPath = path.resolve(coreDirname, settings.options.logPath);\n\n    c.logger.info(`Heta builder of version ${hetaCompilerPackage.version} initialized in directory \"${_coreDirname}\"`);\n    if (settings.id) c.logger.info(`Platform id: \"${settings.id}\"`);\n\n    /*\n        run()\n    */\n    let outputDict = {}; // {<filepath>: <Buffer>}\n    c.logger.info(`Compilation of module \"${settings.importModule.source}\" of type \"${settings.importModule.type}\"...`);\n\n    // 1. Parsing\n    let ms = new ModuleSystem(c.logger, (filename) => {\n        let arrayBuffer = inputDict[filename]; // Uint8Array\n        if (!arrayBuffer) {\n            let e = new Error(`Module ${filename} is not found.`);\n            e.name = 'HetaLevelError'; \n            throw e;\n        }\n        let buffer = Buffer.from(arrayBuffer); // Buffer\n        \n        return buffer;\n    });\n    let sourceFilepath = path.resolve(_coreDirname, settings.importModule.source);\n    let sourceType = settings.importModule.type;\n    ms.addModuleDeep(sourceFilepath, sourceType, settings.importModule);\n\n    // 2. Modules integration\n    if (settings.options.debug) {\n        Object.getOwnPropertyNames(ms.moduleCollection).forEach((name) => {\n            let relPath = path.relative(_coreDirname, name + '.json');\n            let absPath = path.join(_metaDirname, relPath);\n            let str = JSON.stringify(ms.moduleCollection[name], null, 2);\n            outputDict[absPath] = Buffer.from(str, 'utf-8');\n            c.logger.info(`Meta file was saved to ${absPath}`);\n        });\n    }\n    let qArr = ms.integrate();\n    \n    // 3. Translation\n    c.loadMany(qArr, false);\n    \n    // 4. Binding\n    c.logger.info('Setting references in elements, total length ' + c.length);\n    c.knitMany();\n    \n    // 5. Circular start_ and ode_\n    c.logger.info('Checking for circular references in Records.');\n    c.checkCircRecord();\n    \n    // 6. check circ UnitDef\n    c.checkCircUnitDef();\n\n    \n    // === STOP if errors ===\n    if (!c.logger.hasErrors) {\n\n        // 7. Units checking\n        if (settings.options.unitsCheck) {\n          c.logger.info('Checking unit\\'s consistency.');\n          c.checkUnits();\n        } else {\n          c.logger.warn('Units checking skipped. To turn it on set \"unitsCheck: true\" in declaration.');\n        }\n\n        // 8. Terms checking\n        c.logger.info('Checking unit\\'s terms.');\n        c.checkTerms();\n\n        // 9. Exports\n        // save\n        if (settings.options.skipExport) {\n            c.logger.warn('Exporting skipped as stated in declaration.');\n        } else if (settings.options.juliaOnly) {\n            c.logger.warn('\"Julia only\" mode');\n            //this.exportJuliaOnly(); \n            // create export without putting it to exportStorage\n            let Julia = this.container.classes['Julia'];\n            let exportItem = new Julia({\n                format: 'Julia',\n                filepath: '_julia'\n            });\n\n            _makeAndSave(exportItem, _distDirname, outputDict);\n        } else {\n            //this.exportMany();\n            let exportElements = [...c.exportStorage].map((x) => x[1]);\n            c.logger.info(`Start exporting to files, total: ${exportElements.length}.`);\n\n            exportElements.forEach((exportItem) => _makeAndSave(exportItem, _distDirname, outputDict));\n        }\n      } else {\n        c.logger.warn('Units checking and export were skipped because of errors in compilation.');\n      }\n\n    // 10. save logs if required\n    let hetaErrors = c.hetaErrors();\n    let createLog = settings.options.logMode === 'always' \n      || (settings.options.logMode === 'error' && hetaErrors.length > 0);\n    if (createLog) {\n      switch (settings.options.logFormat) {\n      case 'json':\n        var logs = JSON.stringify(c.defaultLogs, null, 2);\n        break;\n      default: \n        logs = c.defaultLogs\n          .filter(x => x.levelNum >= minLevelNum)\n          .map(x => `[${x.level}]\\t${x.msg}`)\n          .join('\\n');  \n      }\n\n      //fs.outputFileSync(_logPath, logs);\n      outputDict[_logPath] = Buffer.from(logs, 'utf-8'); // Buffer\n      c.logger.info(`All logs was saved to file: \"${_logPath}\"`);\n    }\n\n    if (!c.logger.hasErrors) {\n        postMessage({action: 'finished', dict: outputDict});\n    } else {\n        postMessage({action: 'stop', dict: outputDict});\n    }\n    \n    return c;\n}\n\nfunction _makeAndSave(exportItem, distDirectory, outputDict) {\n    let logger = exportItem._container.logger;\n    let filepath0 = path.resolve(distDirectory, exportItem.filepath); // /dist/matlab\n    let msg = `Exporting to \"${filepath0}\" of format \"${exportItem.format}\"...`;\n    logger.info(msg);\n\n    let mmm = exportItem.make();\n\n    mmm.forEach((out) => {\n        let filepath = filepath0 + out.pathSuffix; // /dist/matlab/run.jl\n        try {\n            outputDict[filepath] = out.content;\n        } catch (e) {\n            let msg =`Heta compiler cannot export to file: \"${filepath}\": \\n\\t- ${e.message}`;\n            logger.error(msg, {type: 'ExportError'});\n        }\n    });\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = () => {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [4,926], () => (__webpack_require__(74189)))\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","__webpack_require__.amdD = function () {\n\tthrow new Error('define cannot be used indirect');\n};","__webpack_require__.amdO = {};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"js/\" + chunkId + \".\" + {\"4\":\"67ba40941a58611822d7\",\"926\":\"f4aa2ff36d0ab405b928\"}[chunkId] + \".js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && !scriptUrl) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl + \"../\";","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t929: 1\n};\n\n// importScripts chunk loading\nvar installChunk = (data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkheta_online\"] = self[\"webpackChunkheta_online\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["deferred","next","ajv","Ajv","allErrors","useDefaults","addKeyword","keyword","type","validate","compile","declarationSchema","contactMessage","concat","hetaCompilerPackage","levels","_makeAndSave","exportItem","distDirectory","outputDict","logger","_container","filepath0","path","filepath","msg","format","info","make","forEach","out","pathSuffix","content","e","message","error","self","onmessage","evt","inputDict","data","files","postMessage","action","value","declarationFileName","find","x","declarationBuffer","declarationText","TextDecoder","decode","declaration","yamlLoad","errors","ajvError","instancePath","semver","builderVersion","container","settings","_settings$options","coreDirname","c","Container","minLogLevel","options","logLevel","minLevelNum","indexOf","addTransport","level","opt","levelNum","_coreDirname","_distDirname","distDir","_metaDirname","metaDir","_logPath","logPath","id","importModule","source","ms","ModuleSystem","filename","arrayBuffer","Error","name","Buffer","from","sourceFilepath","sourceType","addModuleDeep","debug","Object","getOwnPropertyNames","moduleCollection","relPath","absPath","str","JSON","stringify","qArr","integrate","loadMany","length","knitMany","checkCircRecord","checkCircUnitDef","hasErrors","warn","unitsCheck","checkUnits","checkTerms","skipExport","juliaOnly","Julia","this","classes","exportElements","_toConsumableArray","exportStorage","map","hetaErrors","logMode","logFormat","logs","defaultLogs","filter","join","dict","build","stack","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","loaded","__webpack_modules__","call","m","__webpack_exports__","O","amdD","amdO","result","chunkIds","fn","priority","notFulfilled","Infinity","i","fulfilled","j","keys","every","key","splice","r","n","getter","__esModule","d","a","definition","o","defineProperty","enumerable","get","f","chunkId","Promise","all","reduce","promises","u","miniCssF","g","globalThis","Function","window","obj","prop","prototype","hasOwnProperty","Symbol","toStringTag","nmd","paths","children","scriptUrl","importScripts","location","document","currentScript","src","scripts","getElementsByTagName","replace","p","installedChunks","chunkLoadingGlobal","parentChunkLoadingFunction","push","bind","moreModules","runtime","pop","then"],"sourceRoot":""}